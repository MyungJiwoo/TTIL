## 📅 2025-10-23 TIL

### 💻 오늘 한 일

- `@together-dog/ui` 패키지에 **공통 Button 컴포넌트** 구현
- **Storybook**을 사용해 버튼 디자인 시스템 문서화
- **Tailwind v4 + Next.js** 통합 과정에서 CSS 파싱 에러(`@source inline`) 트러블슈팅
- safelist 분리(`safelist.css`)로 빌드 및 Vercel 프리뷰 정상 동작 확인

---

### 🧠 배운 점

- Tailwind v4부터는 `safelist` 속성이 사라지고,  
  `@source inline`을 사용해 safelist 처리를 해야 한다는 점
- Next.js는 CSS를 Tailwind로 처리하기 전에 문법 검사를 수행하므로,  
  커스텀 디렉티브(`@source inline`)는 반드시 별도 CSS 파일에서 선언해야 함

---

### 🧩 트러블슈팅

#### ❌ 문제

`Parsing CSS source code failed (Unexpected token '*')`

#### 🔍 원인

Next.js가 `@source inline("{hover:,focus:,active:}{bg,text,border,shadow}-[var(--color-*)]")`  
구문을 Tailwind로 처리하기 전에 직접 파싱하여 문법 에러 발생

#### ✅ 해결

- `@source inline`을 별도 파일(`safelist.css`)로 분리
- Tailwind 설정의 `content` 경로에 safelist.css 포함
- Next.js가 해당 파일을 읽지 않도록 분리하여 정상 빌드 완료

---

### 💬 느낀 점

- Tailwind v4는 성능은 확실히 좋아졌지만, 내부 구조가 바뀌면서  
  기존 방식(safelist, config 확장)을 그대로 쓰면 에러가 잘 난다.
- 직접 문제를 디버깅하면서 “**Next.js 빌드 순서와 Tailwind 전처리 순서의 차이**”를  
  명확히 이해하게 됐고, 앞으로 환경 세팅할 때 훨씬 수월할 것 같다.
